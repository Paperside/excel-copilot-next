# Python Executor

ç‹¬ç«‹çš„Pythonä»£ç æ‰§è¡ŒæœåŠ¡,ä¸ºExcel Copilot Agentæä¾›Jupyter Kernelç¯å¢ƒã€‚

## åŠŸèƒ½ç‰¹æ€§

- ğŸ” æ¯ç”¨æˆ·ç‹¬ç«‹çš„Jupyter Kernel
- â±ï¸ è‡ªåŠ¨è¶…æ—¶æ¸…ç†(30åˆ†é’Ÿæ— æ´»åŠ¨)
- ğŸ“¦ é¢„åŠ è½½å¸¸ç”¨åº“(Polars, Pandas, Matplotlib, jieba)
- ğŸ¨ æ”¯æŒè¿”å›å›¾ç‰‡(matplotlibå›¾è¡¨)
- ğŸ›¡ï¸ ä»£ç æ‰§è¡Œæ²™ç®±(ä»…èƒ½è®¿é—®ç”¨æˆ·ç›®å½•)

## API

### POST /execute

æ‰§è¡ŒPythonä»£ç 

**è¯·æ±‚ä½“**:
```json
{
  "userId": "user123",
  "code": "import polars as pl\ndf = pl.read_excel('data.xlsx')\nprint(df.head())",
  "workingDir": "/path/to/user/dir"
}
```

**å“åº”**:
```json
{
  "success": true,
  "output": "shape: (5, 3)\n...",
  "error": null,
  "result": null,
  "plots": [],
  "executionTime": 0.123
}
```

### GET /health

å¥åº·æ£€æŸ¥

### GET /kernels

è·å–æ‰€æœ‰æ´»è·ƒçš„Kernelä¿¡æ¯(ä»…å¼€å‘ç¯å¢ƒ)

## æµ‹è¯•

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
uv run pytest tests/ -v

# è¿è¡Œç‰¹å®šæµ‹è¯•
uv run pytest tests/test_executor.py -v

# æŸ¥çœ‹è¦†ç›–ç‡
uv run pytest tests/ --cov=src --cov-report=html
```

## å¼€å‘

```bash
# å®‰è£…ä¾èµ–
uv sync

# è¿è¡ŒæœåŠ¡å™¨
uv run python src/main.py

# è¿è¡Œæµ‹è¯•
uv run pytest tests/ -v
```

## æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        FastAPI HTTP Server           â”‚
â”‚         (POST /execute)              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       KernelManager                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ User1 â†’ Jupyter Kernel 1    â”‚   â”‚
â”‚  â”‚ User2 â†’ Jupyter Kernel 2    â”‚   â”‚
â”‚  â”‚ User3 â†’ Jupyter Kernel 3    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       CodeExecutor                   â”‚
â”‚   (æ‰§è¡Œä»£ç  + æ”¶é›†è¾“å‡º)                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## é™åˆ¶

- æœ€å¤§æ‰§è¡Œæ—¶é—´: 60ç§’
- æœ€å¤§Kernelç©ºé—²æ—¶é—´: 30åˆ†é’Ÿ
- æ¯ç”¨æˆ·æœ€å¤š3ä¸ªå¹¶å‘Kernel
- ä»…èƒ½è®¿é—®æŒ‡å®šçš„ç”¨æˆ·ç›®å½•

## å®‰å…¨æ€§

- ä»£ç åœ¨éš”ç¦»çš„Kernelä¸­æ‰§è¡Œ
- é™åˆ¶æ–‡ä»¶ç³»ç»Ÿè®¿é—®(ä»…ç”¨æˆ·ç›®å½•)
- ç¦æ­¢ç½‘ç»œè®¿é—®(TODO)
- ç¦æ­¢å¯¼å…¥å±é™©æ¨¡å—(TODO)
